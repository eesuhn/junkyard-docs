openapi: 3.1.0
info:
  title: Junkyard
  version: 1.0.0
  description: Core Junkyard API
servers:
  - url: https://junkyard.fly.dev
security:
  - ApiKeyAuth: []
paths:
  /loopscale/loop/markets:
    get:
      summary: Loop Markets (Loop ID)
      description: Fetch all loop markets or perform a fuzzy search by name, from Loopscale
      operationId: get-loop-markets
      x-mint:
        href: /reference/get-loop-markets
      tags:
        - Loopscale (Loop)
      parameters:
        - name: name
          in: query
          required: false
          schema:
            type: string
          description: Optional name to perform fuzzy search (case-insensitive)
        - name: include_closed
          in: query
          required: false
          schema:
            type: boolean
            default: false
          description: Whether to include closed markets
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 50
          description: Number of results to return per page
        - name: cursor
          in: query
          required: false
          schema:
            type: string
          description: Cursor for pagination (loop_id to start after)
      responses:
        "200":
          description: Successfully fetched loop markets
          content:
            application/json:
              schema:
                type: object
                required:
                  - data
                  - next_cursor
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      required:
                        - loop_id
                        - name
                        - collateral_mint
                        - principal_mint
                      properties:
                        loop_id:
                          type: string
                          description: Loop market identifier
                        name:
                          type: string
                          description: Display name of the loop market
                        collateral_mint:
                          type: string
                          description: Solana mint address of the collateral token
                        principal_mint:
                          type: string
                          description: Solana mint address of the principal token
                  next_cursor:
                    type: string
                    nullable: true
                    description: Cursor for next page (null if no more results)
              example:
                data:
                  - loop_id: shyusd-usdc
                    name: sHYUSD / USDC
                    collateral_mint: HnnGv3HrSqjRpgdFmx7vQGjntNEoex1SU4e9Lxcxuihz
                    principal_mint: EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v
                  - loop_id: shyusd-hyusd
                    name: sHYUSD / hyUSD
                    collateral_mint: HnnGv3HrSqjRpgdFmx7vQGjntNEoex1SU4e9Lxcxuihz
                    principal_mint: 5YMkXAYccHSGnHn9nob9xEvv6Pvka9DZWH7nTbotTu9E
                  - loop_id: usdstar-2506-usdc
                    name: "[Closed] PT-USD*-2506 / USDC"
                    collateral_mint: F3GhNdzjguv1gkh5ZN8DGTydkHJ4gDjokQkeMg6u97mu
                    principal_mint: EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v
                next_cursor: usdstar-2506-usdc
  /loopscale/loop/apy:
    get:
      summary: Loop APY by ID
      description: Get net APY for any leveraged loop strategy from Loopscale by loop ID
      operationId: get-loop-apy
      x-mint:
        href: /reference/get-loop-apy
      tags:
        - Loopscale (Loop)
      parameters:
        - name: loop_id
          in: query
          required: true
          schema:
            type: string
          description: Loopscale loop market ID
          example: shyusd-hyusd
        - name: leverage
          in: query
          required: false
          schema:
            type: number
            format: float
            minimum: 1.0
            maximum: 9.0
            default: 1.0
          description: Leverage factor between 1.0 and 9.0
        - name: include_mint_addrs
          in: query
          required: false
          schema:
            type: boolean
            default: false
          description: Whether to include mint addresses
      responses:
        "200":
          description: Successfully calculated loop APY
          content:
            application/json:
              schema:
                type: object
                required:
                  - loop_id
                  - name
                  - net_apy
                  - base_apy
                  - borrow_apy
                properties:
                  loop_id:
                    type: string
                    description: Loop market identifier
                  name:
                    type: string
                    description: Display name of the loop strategy
                  net_apy:
                    type: number
                    format: float
                    description: Net APY after accounting for leverage and borrowing costs
                  base_apy:
                    type: number
                    format: float
                    description: Base APY from the collateral asset
                  borrow_apy:
                    type: number
                    format: float
                    description: APY cost of borrowing the principal asset
                  include:
                    type: object
                    description: Additional data
                    properties:
                      collateral_mint:
                        type: string
                        description: Solana mint address of the collateral token
                      principal_mint:
                        type: string
                        description: Solana mint address of the principal token
              example:
                loop_id: shyusd-hyusd
                name: sHYUSD / hyUSD
                net_apy: 25.068267
                base_apy: 13.622467
                borrow_apy: 12.0
                include:
                  collateral_mint: HnnGv3HrSqjRpgdFmx7vQGjntNEoex1SU4e9Lxcxuihz
                  principal_mint: 5YMkXAYccHSGnHn9nob9xEvv6Pvka9DZWH7nTbotTu9E
components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: x-api-key
